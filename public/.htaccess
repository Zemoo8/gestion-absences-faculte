<IfModule mod_rewrite.c>
    RewriteEngine On
    # Adjust this RewriteBase if your project is served from a different subfolder
    RewriteBase /projet/Gestion-absences/public/

    # Proxy chatbot API requests to Flask backend on localhost:5000
    RewriteCond %{REQUEST_URI} ^/projet/Gestion-absences/public/api/chat$
    RewriteRule ^api/chat$ http://localhost:5000/chat [P,L]

    # If the request is for an existing file or directory, serve it directly
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Otherwise rewrite everything to index.php (front controller)
    RewriteRule ^ index.php [L,QSA]
</IfModule>

# Fallback for servers without mod_rewrite
<IfModule !mod_rewrite.c>
    ErrorDocument 404 /index.php
</IfModule>
# Gestion d'Absences MVC - .htaccess

# Enable rewrite engine
RewriteEngine On

# Set rewrite base (adjust if project is in subdirectory)
RewriteBase /

# Prevent direct access to .htaccess files
<FilesMatch "^\.ht">
    Require all denied
</FilesMatch>

# Prevent directory browsing
Options -Indexes

# Handle PHP errors
php_flag display_errors Off
php_flag log_errors On
php_value error_log "../logs/php_errors.log"

# Redirect all requests to index.php except existing files
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?$1 [QSA,L]

# Custom error pages (optional)
ErrorDocument 404 /public/index.php
ErrorDocument 500 /public/index.php